好的！我帮你把之前的“命令管理”模块需求文档和“上传文件到OSS”功能合并，去重、补充，形成一份完整、清晰的**虚拟机命令管理模块（含OSS文件上传与管理）前端交互需求文档**，方便你做原型设计。

---

# 虚拟机命令管理模块 — 前端交互需求文档（含 OSS 文件上传与管理）

## 1. 功能概述

本模块支持用户管理命令模板，上传和管理 OSS 文件，执行命令时关联 OSS 文件（可选），选择目标虚拟机执行命令，并返回执行结果，简化虚拟机运维操作。

---

## 2. 页面结构与交互

### 2.1 文件上传与 OSS 文件管理

#### 2.1.1 上传文件入口

* 在“文件管理”页面均提供“上传文件”按钮。
* 点击后弹出文件选择对话框，支持单文件或多文件选择。
* 上传时显示实时进度条，上传完成自动刷新文件列表。

#### 2.1.2 OSS 文件列表

* 展示用户已上传至 OSS Bucket 的文件，列表字段包括：

  * 文件名称
  * 文件大小
  * 更新时间
* 支持搜索和分页功能。
* 支持文件删除操作，删除时有确认弹窗。
* 文件夹支持多层级

---

### 2.2 命令管理列表页

* 显示所有命令模板，字段包括：

  * 命令名称
  * 标签（部署/调试/维护等）
  * 命令描述（可选）
* 操作按钮：【编辑】、【删除】、【执行】
* 页面顶部有【新建命令】按钮。

---

### 2.3 新建 / 编辑命令页

* **输入项**：

  * 命令名称（必填）
  * 命令模板（必填，支持 `{file}` 占位符）
  * 标签（可选，支持单选或多选）
  * 描述（可选，多行文本）

* **交互说明**：

  * 用户可输入任意命令文本。
  * `{file}` 占位符表示执行时可关联 OSS 文件，若模板中包含该占位符，执行时必须选择文件。
  * 点击保存前进行必填校验。

* **操作按钮**：

  * 【保存】
  * 【取消】

---

### 2.4 执行命令弹窗

#### 2.4.1 基本流程

1. 用户点击命令列表中的【执行】按钮，弹出执行弹窗。

2. 弹窗中首先选择目标虚拟机（单选下拉）。

3. 判断命令模板是否包含 `{file}` 占位符：

   * **包含**：显示 OSS 文件选择器（同文件管理列表的简化版本）。
   * **不包含**：隐藏文件选择器。

4. 如果需要选择文件，用户必须从 OSS 文件列表中选取一个文件。

5. 点击【执行命令】后，弹窗显示“正在执行，请稍候...”，执行完成后关闭弹窗。

6. 页面下方以弹窗或提示框形式展示执行结果（成功或错误摘要）。
7. 命令详情页展示执行的历史记录：保存每次执行的命令、文件名、目标虚机、结果日志（方便追溯）。

#### 2.4.2 文件选择器细节

* 支持搜索和分页。
* 只能单选文件。
* 展示文件名

---

## 3. 交互流程总结

### 3.1 文件上传及管理

* 用户在“文件管理”或“命令管理”页面上传本地文件到 OSS。
* 上传完成后文件自动显示在 OSS 文件列表。
* 用户可搜索、浏览、删除文件。

### 3.2 命令创建与执行

* 用户创建命令模板，支持 `{file}` 作为文件占位符。
* 命令保存后显示在命令列表。
* 用户点击【执行】选择虚拟机。
* 如果命令包含 `{file}`，弹出文件选择器让用户选择 OSS 文件。
* 点击执行，等待执行结果。
* 显示命令执行成功或失败的摘要信息。

---

## 4. 重点说明

* 命令执行时 `{file}` 占位符对应的文件必须是已上传到 OSS 的文件。
* 文件上传和选择是分步操作，执行命令时不支持直接上传文件。
* 不支持批量选择虚拟机执行，单次执行仅针对一个虚拟机。
* 不支持实时展示命令执行状态，仅展示最终执行结果。
* 执行结果只显示成功或错误摘要，详细日志由后端存储并另行查看。

---

## 5. 原型设计建议

* **文件管理页面**：

  * 顶部操作栏含“上传文件”按钮和搜索框。
  * 文件列表清晰展示文件信息和删除操作。
* **命令管理页面**：

  * 命令列表展示命令相关信息，操作按钮明显。
  * 支持新建和编辑命令弹窗。
* **执行命令弹窗**：

  * 结构清晰，包含虚拟机选择和文件选择（条件显示）。
  * 执行按钮反馈明确，执行完毕后弹窗自动关闭并展示结果。

---

